# 51单片机
1. 可位寻址：TCON ``` TF1=0;//软件清零，TF1为B7 ```
   不可位寻址：TCOM ``` TCOM=0x10;//即M0=1 ```

## 数码管
1. LED显示器工作方式有两种：静态显示方式和动态显示方式
   - 静态显示:每个数码管的段选必须接一个8位数据线来保持显示的字形码。当送入一次字形码后，显示字形可一直保持，直到送入新字形码为止
   - **动态显示**:将所有位数码管的段选线并联在一起，由位选线控制是哪一位数码管有效。选亮数码管采用动态扫描显示。所谓动态扫描显示即轮流向各位数码管送出字形码和相应的位选，利用发光管的余辉和人眼视觉暂留作用，使人的感觉好像各位数码管同时都在显示
2. 数码管段名
   ![](./笔记and笔记图片/数码管段名.PNG)(dp=h)
3. ```c
   共阴数码管段选表
   0x3F,  //"0"
   0x06,  //"1"
   0x5B,  //"2"
   0x4F,  //"3"
   0x66,  //"4"
   0x6D,  //"5"
   0x7D,  //"6"
   0x07,  //"7"
   0x7F,  //"8"
   0x6F,  //"9"
   0x77,  //"A"
   0x7C,  //"B"
   0x39,  //"C"
   0x5E,  //"D"
   0x79,  //"E"
   0x71,  //"F"
   0x76,  //"H"
   0x38,  //"L"
   0x40,  //"-"
   0x00,  //熄灭
   ```
4. 每一位数码管显示完需延时

 ## 中断系统
1. 数据传输方式：
   - 无条件传送方式
   - 查询传送方式，若准备好才传送，如温度传感器
   - 中断传送
   - 直接存储器存取
2. 中断源：
   - 外部(中断源标志、触发方式由特殊功能寄存器TCON低四位控制)：INT0(P3.2),INT1(P3.3),低电平或下降沿引起
   - 内部(控制位锁存在TCON和SCON中)：T0,T1,定时器回零溢出引起；TI/RI,串行I/O中断，串行端口完成一帧字符发送/接受引起
3. 中断优先级及入口号
   ![](./笔记and笔记图片/中断优先级及入口号.PNG)
4. c语言示例（外部中断1）
   ```C 
   void int1Init()//外部中断1初始化
   {
   EA = 1;//打开总中断  
   EX1 = 1;//打开外部中断1
   IT1 = 1;//下降沿引发
   }
   ……
   void int1() interrupt 2//interrupt+中断入口号
   {
		中断处理语句
   }
   ```

## 定时/计数器
1. 作用：精确事件定时，PWM脉宽调制，波形发生，信号时许测量
2. TCON：
   - 用查询法查询是否益处，TF0/1要程序清零；中断用硬件清零
   - TR0/1为定时器开关
3. TMOD: 
   - ![工作方式表](./笔记and笔记图片/定时器工作方式表.png)
   - 8位自动重装定时器：低8位溢出后，把高8位的值赋给低8位
   - C/T 6(2)：定时/计数模式切换 0定时 1计数
4. 程序示例
   ```c
   void timer0Init()//定时器0初始化
   {
      TMOD = 0x01;//16位定时器
      TH0 = (65535-要定时的时间(μs)/机器周期(μs))/256;
      TL0 = (65535-要定时的时间(μs)/机器周期(μs))%256;
   } 

   int main()
   {
      timer0Init();
      TR0 = 1;//打开计时器0
      /*EA = 1;ET0 = 1;打开中断开关*/
      while(1)
      {
         /*查询
         if(TF0 == 1)
         {
            TF0 = 0;//软件清零，用中断方式不需要
            执行任务
         }
         */
      }
   }

   void timer0() interrupt 1//如需计数，变量要设为全局变量
   {
      TH0 = (65535-要定时的时间(μs)/机器周期(μs))/256;
      TL0 = (65535-要定时的时间(μs)/机器周期(μs))%256;//手动重新设定初值
		中断处理语句
   }
   ```
## STM32F103C8T6
1. IO口是上拉还是下拉要根据，IO口外部接的空闲电平有关，如按键不按下时是低电平，则应该设置为下拉输入。